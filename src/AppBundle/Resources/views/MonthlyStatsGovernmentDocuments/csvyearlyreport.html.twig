{# This twig snippet takes in MonthlyStatsGovernmentDocuments entities and row headers for CSV file generation. #}
    {# Totals #}
    {% set totalItemsAddedGross = 0 %}
    {% set totalItemsWithdrawn = 0 %}
    {% set totalPapers = 0 %}
    {% set totalOPAC = 0 %}
    {% set totalWeeklyRecordsAdded = 0 %}
    {% set totalMonthlyRecordsAdded = 0 %}
    {% set totalMonthlyNonOverlays = 0 %}
Government Documents Statistics: {{ type|capitalize }} Year {{ year }}
{% if options.holdings is defined %}
    {% if type == 'calendar' %}
        {{ options.holdings|capitalize }},Jan '{{year|slice(2,2)}},Feb '{{year|slice(2,2)}},Mar '{{year|slice(2,2)}},Apr '{{year|slice(2,2)}},May '{{year|slice(2,2)}},Jun '{{year|slice(2,2)}},Jul '{{year|slice(2,2)}},Aug '{{year|slice(2,2)}},Sep '{{year|slice(2,2)}},Oct '{{year|slice(2,2)}},Nov '{{year|slice(2,2)}},Dec '{{year|slice(2,2)}}, TOTAL,
    {% elseif type == 'fiscal' %}
        {{ options.holdings|capitalize }},Jul '{{year|slice(2,2)}},Aug '{{year|slice(2,2)}},Sep '{{year|slice(2,2)}},Oct '{{year|slice(2,2)}},Nov '{{year|slice(2,2)}},Dec '{{year|slice(2,2)}},Jan '{{year|slice(7,2)}},Feb '{{year|slice(7,2)}},Mar '{{year|slice(7,2)}},Apr '{{year|slice(7,2)}},May '{{year|slice(7,2)}},Jun '{{year|slice(7,2)}}, TOTAL,
    {% endif %}
Items Added (gross),{% for monthly in entities %}{% if monthly == null %}0,{% else %}{% set totalItemsAddedGross = totalItemsAddedGross + monthly.itemsAddedGross %}{{ monthly.itemsAddedGross }},{% endif %}{% endfor %}{{ totalItemsAddedGross }},
Items Withdrawn,{% for monthly in entities %}{% if monthly == null %}0,{% else %}{% set totalItemsWithdrawn = totalItemsWithdrawn + monthly.itemsWithdrawn %}{{ monthly.itemsWithdrawn }},{% endif %}{% endfor %}{{ totalItemsWithdrawn }},
NET Items Added,{% for monthly in entities %}{% if monthly == null %}0,{% else %}{{ monthly.itemsAddedGross - monthly.itemsWithdrawn }},{% endif %}{% endfor %}{{ totalItemsAddedGross - totalItemsWithdrawn }},
{% endif %}
 
{% if options.usage is defined %}
    {% if type == 'calendar' %}
        {{ options.usage|capitalize }},Jan '{{year|slice(2,2)}},Feb '{{year|slice(2,2)}},Mar '{{year|slice(2,2)}},Apr '{{year|slice(2,2)}},May '{{year|slice(2,2)}},Jun '{{year|slice(2,2)}},Jul '{{year|slice(2,2)}},Aug '{{year|slice(2,2)}},Sep '{{year|slice(2,2)}},Oct '{{year|slice(2,2)}},Nov '{{year|slice(2,2)}},Dec '{{year|slice(2,2)}}, TOTAL,
    {% elseif type == 'fiscal' %}
        {{ options.usage|capitalize }},Jul '{{year|slice(2,2)}},Aug '{{year|slice(2,2)}},Sep '{{year|slice(2,2)}},Oct '{{year|slice(2,2)}},Nov '{{year|slice(2,2)}},Dec '{{year|slice(2,2)}},Jan '{{year|slice(7,2)}},Feb '{{year|slice(7,2)}},Mar '{{year|slice(7,2)}},Apr '{{year|slice(7,2)}},May '{{year|slice(7,2)}},Jun '{{year|slice(7,2)}}, TOTAL,
    {% endif %}
Paper,{% for monthly in entities %}{% if monthly == null %}0,{% else %}{% set totalPapers = totalPapers + monthly.paper %}{{ monthly.paper }},{% endif %}{% endfor %}{{ totalPapers }},
Electronic (OPAC URLs),{% for monthly in entities %}{% if monthly == null %}0,{% else %}{% set totalOPAC = totalOPAC + monthly.electronicOpacUrls %}{{ monthly.electronicOpacUrls }},{% endif %}{% endfor %}{{ totalOPAC }},
{% endif %}
 
{% if options.processing is defined %}
    {% if type == 'calendar' %}
        {{ options.processing|capitalize }},Jan '{{year|slice(2,2)}},Feb '{{year|slice(2,2)}},Mar '{{year|slice(2,2)}},Apr '{{year|slice(2,2)}},May '{{year|slice(2,2)}},Jun '{{year|slice(2,2)}},Jul '{{year|slice(2,2)}},Aug '{{year|slice(2,2)}},Sep '{{year|slice(2,2)}},Oct '{{year|slice(2,2)}},Nov '{{year|slice(2,2)}},Dec '{{year|slice(2,2)}}, TOTAL,
    {% elseif type == 'fiscal' %}
        {{ options.processing|capitalize }},Jul '{{year|slice(2,2)}},Aug '{{year|slice(2,2)}},Sep '{{year|slice(2,2)}},Oct '{{year|slice(2,2)}},Nov '{{year|slice(2,2)}},Dec '{{year|slice(2,2)}},Jan '{{year|slice(7,2)}},Feb '{{year|slice(7,2)}},Mar '{{year|slice(7,2)}},Apr '{{year|slice(7,2)}},May '{{year|slice(7,2)}},Jun '{{year|slice(7,2)}}, TOTAL,
    {% endif %}
Weekly Records Added,{% for monthly in entities %}{% if monthly == null %}0,{% else %}{% set totalWeeklyRecordsAdded = totalWeeklyRecordsAdded + monthly.weeklyRecordsAdded %}{{ monthly.weeklyRecordsAdded }},{% endif %}{% endfor %}{{ totalWeeklyRecordsAdded }},
Monthly Records Added,{% for monthly in entities %}{% if monthly == null %}0,{% else %}{% set totalMonthlyRecordsAdded = totalMonthlyRecordsAdded + monthly.monthlyRecordsAdded %}{{ monthly.monthlyRecordsAdded }},{% endif %}{% endfor %}{{ totalMonthlyRecordsAdded }},
Monthly Non-Overlays,{% for monthly in entities %}{% if monthly == null %}0,{% else %}{% set totalMonthlyNonOverlays = totalMonthlyNonOverlays + monthly.monthlyNonOverlays %}{{ monthly.monthlyNonOverlays }},{% endif %}{% endfor %}{{ totalMonthlyNonOverlays }},
{% endif %}